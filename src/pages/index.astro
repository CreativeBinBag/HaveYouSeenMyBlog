---
import MainLayout from "../layouts/MainLayout.astro";
import PixelCard from "../components/PixelCard.astro";
import Contact from "../components/Contact.astro";

import { getCollection } from "astro:content";

const posts = await getCollection("blog");
const sortedPosts = posts.sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<MainLayout title="Home">
  <div class="grid md:grid-cols-12 gap-8 mb-20 items-start">
    <div class="md:col-span-4 flex justify-center md:justify-start">
      <div class="relative group">
        <div
          class="absolute -inset-2 bg-p-mint rounded-lg blur opacity-25 group-hover:opacity-75 transition duration-1000"
        >
        </div>
        <img
          src={`${import.meta.env.BASE_URL}avatar.jpg`}
          alt="Nafisa Pixel Art"
          class="relative w-56 h-56 object-cover rendering-pixelated border-4 border-gba-text dark:border-white shadow-pixel-md rotate-2 group-hover:rotate-0 transition-transform duration-300"
        />
      </div>
    </div>

    <div class="md:col-span-8">
      <PixelCard class="h-full flex flex-col justify-center">
        <h2
          class="font-pixel text-4xl mb-6 text-gba-text dark:text-p-mint border-b-4 border-p-pink inline-block pb-1"
        >
          Good Day.
        </h2>

        <div
          class="prose prose-lg dark:prose-invert font-serif leading-relaxed text-lg"
        >
          <p>
            I got sick and tired of social media and decided to make this blog
            site to ramble about (mostly)
            <span class="text-p-blue font-bold"
              >Quantum Science, Art, and pretty much anything that interests me</span
            > .
          </p>
        </div>

        <div
          class="mt-8 p-4 bg-gba-cream dark:bg-black/40 border-l-8 border-p-blue font-pixel text-lg italic text-gray-600 dark:text-gray-300"
        >
          &gt; Any onion here is, of course, my own.
        </div>
      </PixelCard>
    </div>
  </div>

  <div class="flex items-center gap-4 mb-8">
    <h3 class="font-pixel text-3xl text-gba-text dark:text-white">
      // What's on my mind?
    </h3>
    <div
      class="h-1 flex-grow bg-dashed border-t-2 border-gray-300 dark:border-gray-700 border-dashed"
    >
    </div>
  </div>

  <div class="grid gap-6">
    {
      sortedPosts.map((post) => (
        <a
          href={`${import.meta.env.BASE_URL}blog/${post.slug}`}
          class="relative block group"
        >
          <div class="absolute inset-0 bg-p-mint/0 group-hover:bg-p-mint/10 transform transition-all duration-300 -skew-x-2 border border-transparent group-hover:border-p-mint/30" />

          <div class="relative flex flex-col md:flex-row gap-6 p-6 border-l-4 border-gray-300 dark:border-gray-600 group-hover:border-p-pink transition-all">
            <div class="md:w-32 flex-shrink-0 font-pixel text-gray-400 group-hover:text-p-blue pt-1">
              {post.data.date.toISOString().split("T")[0]}
            </div>

            <div>
              <h4 class="text-2xl font-bold font-serif text-gba-text dark:text-gba-cream group-hover:text-p-pink transition-colors mb-2">
                {post.data.title}
              </h4>
              <p class="text-gray-600 dark:text-gray-400 font-serif leading-relaxed">
                {post.data.description || "Reading stream available..."}
              </p>

              <div class="flex gap-2 mt-3">
                {post.data.tags &&
                  post.data.tags.map((tag) => (
                    <span class="text-sm uppercase tracking-wider font-bold text-p-blue dark:text-p-mint font-pixel bg-p-blue/10 dark:bg-p-mint/10 px-3 py-1 rounded-sm">
                      [{tag}]
                    </span>
                  ))}
              </div>
            </div>
          </div>
        </a>
      ))
    }
  </div>
  <Contact />
</MainLayout>
