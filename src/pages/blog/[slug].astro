---
import { getCollection } from "astro:content";
import MainLayout from "../../layouts/MainLayout.astro";
import PixelCard from "../../components/PixelCard.astro";
import GameBoyEmbed from "../../components/GameBoyEmbed.astro";
import RetroVideo from "../../components/RetroVideo.astro";
import Polaroid from "../../components/Polaroid.astro";

export async function getStaticPaths() {
  const blogEntries = await getCollection("blog");
  return blogEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<MainLayout title={entry.data.title}>
  <PixelCard class="max-w-4xl mx-auto px-8 py-10">
    <header
      class="mb-12 border-b-4 border-dashed border-gray-200 dark:border-gray-700 pb-8"
    >
      <div class="flex flex-wrap gap-3 mb-4">
        {
          entry.data.tags &&
            entry.data.tags.map((tag) => (
              <span class="px-3 py-1 bg-p-mint/20 text-p-blue dark:text-p-mint border border-p-mint/50 text-sm font-pixel uppercase tracking-widest rounded-sm">
                #{tag}
              </span>
            ))
        }
      </div>

      <h1
        class="font-serif font-bold text-4xl md:text-6xl text-gba-text dark:text-gba-cream mb-4 leading-tight"
      >
        {entry.data.title}
      </h1>

      <p class="font-pixel text-xl text-gray-500">
        // Logged on {entry.data.date.toISOString().split("T")[0]}
      </p>
    </header>

    <article
      class="prose prose-xl dark:prose-invert max-w-none
      prose-p:font-serif prose-p:text-gray-700 dark:prose-p:text-gray-300 prose-p:leading-8
      prose-headings:font-pixel prose-headings:text-gba-text dark:prose-headings:text-p-pink
      prose-pre:bg-[#1a1a2e] prose-pre:border-2 prose-pre:border-gray-700 prose-pre:shadow-pixel-sm
      prose-img:rounded-sm prose-img:border-2 prose-img:border-black dark:prose-img:border-white"
    >
      <Content components={{ GameBoyEmbed, RetroVideo, Polaroid }} />
    </article>
  </PixelCard>

  <div class="mt-12 text-center">
    <a
      href="/"
      class="inline-block px-6 py-2 bg-gray-200 dark:bg-gray-800 font-pixel text-xl hover:bg-p-pink hover:text-white transition-colors shadow-pixel-sm"
    >
      &lt; Return
    </a>
  </div>
</MainLayout>
